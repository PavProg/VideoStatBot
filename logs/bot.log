2025-12-16 00:08:22 - __main__ - INFO - Запуск приложения...
2025-12-16 00:08:22 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:08:22 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:08:22 - __main__ - INFO - База данных инициализирована
2025-12-16 00:08:23 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:08:23 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:08:23 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:08:38 - aiogram.event - INFO - Update id=738227696 is handled. Duration 248 ms by bot id=7844736553
2025-12-16 00:09:49 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:09:49 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:09:50 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) \nFROM videos \nJOIN snapshots ON videos.video_id = snapshots.video_id \nWHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' \n  AND snapshots.views_count > 10000;"
2025-12-16 00:09:50 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000"
2025-12-16 00:09:50 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:09:50 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:09:50 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:09:50 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:09:50 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-12-16 00:09:50 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:09:50 - aiogram.event - INFO - Update id=738227697 is handled. Duration 1368 ms by bot id=7844736553
2025-12-16 00:11:09 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:11:09 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:11:09 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:11:09 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:11:15 - __main__ - INFO - Запуск приложения...
2025-12-16 00:11:15 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:11:15 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:11:15 - __main__ - INFO - База данных инициализирована
2025-12-16 00:11:15 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:11:15 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:11:15 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:11:25 - aiogram.event - INFO - Update id=738227698 is handled. Duration 232 ms by bot id=7844736553
2025-12-16 00:11:36 - src.bot.handlers.handlers - INFO - Получен запрос Сколько всего видео?
2025-12-16 00:11:36 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько всего видео?
2025-12-16 00:11:37 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): 'SELECT COUNT(*) FROM videos;'
2025-12-16 00:11:37 - src.llm_service.llm_service - INFO - Очищенный SQL: 'SELECT COUNT(*) FROM videos'
2025-12-16 00:11:37 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos
2025-12-16 00:11:37 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos
2025-12-16 00:11:37 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:11:37 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos
2025-12-16 00:11:37 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-12-16 00:11:37 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-16 00:11:37 - src.bot.handlers.handlers - ERROR - Ошибка обработки запросов: 'str' object has no attribute 'edit_text'
Traceback (most recent call last):
  File "D:\WrokingProjects\PythonProject\src\bot\handlers\handlers.py", line 63, in handle_text_query
    await processing_msg.edit_text(response)
          ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'edit_text'
2025-12-16 00:11:37 - aiogram.event - INFO - Update id=738227699 is not handled. Duration 448 ms by bot id=7844736553
2025-12-16 00:11:37 - aiogram.event - ERROR - Cause exception while process update id=738227699 by bot id=7844736553
AttributeError: 'str' object has no attribute 'edit_text'
Traceback (most recent call last):
  File "D:\WrokingProjects\PythonProject\src\bot\handlers\handlers.py", line 63, in handle_text_query
    await processing_msg.edit_text(response)
          ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'edit_text'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\src\bot\handlers\handlers.py", line 67, in handle_text_query
    await processing_msg.edit_text(
          ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'edit_text'
2025-12-16 00:12:59 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:12:59 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:12:59 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:12:59 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:13:04 - __main__ - INFO - Запуск приложения...
2025-12-16 00:13:04 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:13:04 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:13:04 - __main__ - INFO - База данных инициализирована
2025-12-16 00:13:04 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:13:04 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:13:04 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:13:09 - aiogram.event - INFO - Update id=738227700 is handled. Duration 193 ms by bot id=7844736553
2025-12-16 00:13:12 - src.bot.handlers.handlers - INFO - Получен запрос Сколько всего видео?
2025-12-16 00:13:12 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько всего видео?
2025-12-16 00:13:12 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): 'SELECT COUNT(*) FROM videos;'
2025-12-16 00:13:12 - src.llm_service.llm_service - INFO - Очищенный SQL: 'SELECT COUNT(*) FROM videos'
2025-12-16 00:13:12 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos
2025-12-16 00:13:12 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos
2025-12-16 00:13:12 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:13:12 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos
2025-12-16 00:13:12 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-12-16 00:13:12 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:13:13 - aiogram.event - INFO - Update id=738227701 is handled. Duration 565 ms by bot id=7844736553
2025-12-16 00:13:25 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:13:25 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:13:26 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) \nFROM videos \nJOIN snapshots ON videos.video_id = snapshots.video_id \nWHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' \n  AND snapshots.views_count > 10000;"
2025-12-16 00:13:26 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000"
2025-12-16 00:13:26 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:13:26 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:13:26 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:13:26 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:13:26 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ()
2025-12-16 00:13:26 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:13:26 - aiogram.event - INFO - Update id=738227702 is handled. Duration 1336 ms by bot id=7844736553
2025-12-16 00:13:50 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?.
2025-12-16 00:13:50 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?.
2025-12-16 00:13:51 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) \nFROM videos \nJOIN snapshots ON videos.video_id = snapshots.video_id \nWHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' \n  AND snapshots.views_count > 10000;"
2025-12-16 00:13:51 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000"
2025-12-16 00:13:51 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:13:51 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:13:51 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:13:51 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:13:51 - sqlalchemy.engine.Engine - INFO - [cached since 25.12s ago] ()
2025-12-16 00:13:51 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:13:51 - aiogram.event - INFO - Update id=738227703 is handled. Duration 1271 ms by bot id=7844736553
2025-12-16 00:13:57 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:13:57 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:13:57 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:13:57 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:14:42 - __main__ - INFO - Запуск приложения...
2025-12-16 00:14:42 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:14:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:14:42 - __main__ - INFO - База данных инициализирована
2025-12-16 00:14:42 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:14:42 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:14:43 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:14:48 - aiogram.event - INFO - Update id=738227704 is handled. Duration 183 ms by bot id=7844736553
2025-12-16 00:14:56 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:14:56 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:14:58 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) \nFROM videos \nJOIN snapshots ON videos.video_id = snapshots.video_id \nWHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' \n  AND snapshots.views_count > 10000;"
2025-12-16 00:14:58 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000"
2025-12-16 00:14:58 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:14:58 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:14:58 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:14:58 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:14:58 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-12-16 00:14:58 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:14:58 - aiogram.event - INFO - Update id=738227705 is handled. Duration 1292 ms by bot id=7844736553
2025-12-16 00:15:08 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:15:08 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:15:09 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) \nFROM videos \nJOIN snapshots ON videos.video_id = snapshots.video_id \nWHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' \n  AND snapshots.views_count > 10000;"
2025-12-16 00:15:09 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000"
2025-12-16 00:15:09 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:15:09 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:15:09 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:15:09 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos JOIN snapshots ON videos.video_id = snapshots.video_id WHERE videos.creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND snapshots.views_count > 10000
2025-12-16 00:15:09 - sqlalchemy.engine.Engine - INFO - [cached since 11.65s ago] ()
2025-12-16 00:15:09 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:15:09 - aiogram.event - INFO - Update id=738227706 is handled. Duration 1380 ms by bot id=7844736553
2025-12-16 00:20:34 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:20:34 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:20:34 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:20:34 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:20:39 - __main__ - INFO - Запуск приложения...
2025-12-16 00:20:39 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:20:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:20:39 - __main__ - INFO - База данных инициализирована
2025-12-16 00:20:40 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:20:40 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:20:40 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:20:49 - aiogram.event - INFO - Update id=738227707 is handled. Duration 191 ms by bot id=7844736553
2025-12-16 00:20:58 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:20:58 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:20:59 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000"
2025-12-16 00:20:59 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000"
2025-12-16 00:20:59 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000
2025-12-16 00:20:59 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000
2025-12-16 00:20:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:20:59 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000
2025-12-16 00:20:59 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-12-16 00:20:59 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:20:59 - aiogram.event - INFO - Update id=738227708 is handled. Duration 973 ms by bot id=7844736553
2025-12-16 00:21:03 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:21:03 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:21:03 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:21:03 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:22:10 - __main__ - INFO - Запуск приложения...
2025-12-16 00:22:10 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:22:10 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:22:10 - __main__ - INFO - База данных инициализирована
2025-12-16 00:22:10 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:22:10 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:22:10 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:22:20 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:22:20 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео у креатора с id aca1061a9d324ecf8c3fa2bb32d7be63 набрали больше 10 000 просмотров по итоговой статистике?
2025-12-16 00:22:21 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000"
2025-12-16 00:22:21 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000"
2025-12-16 00:22:21 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000
2025-12-16 00:22:21 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000
2025-12-16 00:22:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:22:21 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM videos WHERE creator_id = 'aca1061a9d324ecf8c3fa2bb32d7be63' AND views_count > 10000
2025-12-16 00:22:21 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-12-16 00:22:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:22:21 - aiogram.event - INFO - Update id=738227709 is handled. Duration 1103 ms by bot id=7844736553
2025-12-16 00:22:22 - src.bot.handlers.handlers - INFO - Получен запрос Сколько видео опубликовал креатор с id 8b76e572635b400c9052286a56176e03 в период с 1 ноября 2025 по 5 ноября 2025 включительно? Под периодом иметь в виду дату публикации видео.
2025-12-16 00:22:22 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько видео опубликовал креатор с id 8b76e572635b400c9052286a56176e03 в период с 1 ноября 2025 по 5 ноября 2025 включительно? Под периодом иметь в виду дату публикации видео.
2025-12-16 00:22:24 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT COUNT(DISTINCT video_id) FROM videos WHERE creator_id = '8b76e572635b400c9052286a56176e03' AND DATE(video_created_at) BETWEEN '2025-11-01' AND '2025-11-05'"
2025-12-16 00:22:24 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT COUNT(DISTINCT video_id) FROM videos WHERE creator_id = '8b76e572635b400c9052286a56176e03' AND DATE(video_created_at) BETWEEN '2025-11-01' AND '2025-11-05'"
2025-12-16 00:22:24 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(DISTINCT video_id) FROM videos WHERE creator_id = '8b76e572635b400c9052286a56176e03' AND DATE(video_created_at) BETWEEN '2025-11-01' AND '2025-11-05'
2025-12-16 00:22:24 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(DISTINCT video_id) FROM videos WHERE creator_id = '8b76e572635b400c9052286a56176e03' AND DATE(video_created_at) BETWEEN '2025-11-01' AND '2025-11-05'
2025-12-16 00:22:24 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:22:24 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(DISTINCT video_id) FROM videos WHERE creator_id = '8b76e572635b400c9052286a56176e03' AND DATE(video_created_at) BETWEEN '2025-11-01' AND '2025-11-05'
2025-12-16 00:22:24 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-12-16 00:22:24 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:22:24 - aiogram.event - INFO - Update id=738227710 is handled. Duration 2304 ms by bot id=7844736553
2025-12-16 00:22:25 - src.bot.handlers.handlers - INFO - Получен запрос Сколько всего есть замеров статистики (по всем видео), в которых число просмотров за час оказалось отрицательным — то есть по сравнению с предыдущим замером количество просмотров стало меньше?
2025-12-16 00:22:25 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Сколько всего есть замеров статистики (по всем видео), в которых число просмотров за час оказалось отрицательным — то есть по сравнению с предыдущим замером количество просмотров стало меньше?
2025-12-16 00:22:25 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): 'SELECT COUNT(*) FROM snapshots WHERE delta_views_count < 0'
2025-12-16 00:22:25 - src.llm_service.llm_service - INFO - Очищенный SQL: 'SELECT COUNT(*) FROM snapshots WHERE delta_views_count < 0'
2025-12-16 00:22:25 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT COUNT(*) FROM snapshots WHERE delta_views_count < 0
2025-12-16 00:22:25 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT COUNT(*) FROM snapshots WHERE delta_views_count < 0
2025-12-16 00:22:25 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:22:25 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM snapshots WHERE delta_views_count < 0
2025-12-16 00:22:25 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-12-16 00:22:25 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:22:25 - aiogram.event - INFO - Update id=738227711 is handled. Duration 512 ms by bot id=7844736553
2025-12-16 00:22:26 - src.bot.handlers.handlers - INFO - Получен запрос Какое суммарное количество просмотров набрали все видео, опубликованные в июне 2025 года?
2025-12-16 00:22:26 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Какое суммарное количество просмотров набрали все видео, опубликованные в июне 2025 года?
2025-12-16 00:22:27 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): "SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06'"
2025-12-16 00:22:27 - src.llm_service.llm_service - INFO - Очищенный SQL: "SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06'"
2025-12-16 00:22:27 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06'
2025-12-16 00:22:27 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06'
2025-12-16 00:22:27 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:22:27 - sqlalchemy.engine.Engine - INFO - SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06'
2025-12-16 00:22:27 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ()
2025-12-16 00:22:27 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-16 00:22:27 - src.bot.handlers.handlers - ERROR - Ошибка обработки запросов: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidDatetimeFormatError'>: неверный синтаксис для типа date: "2025-06"
[SQL: SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06']
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\asyncpg\connection.py", line 638, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\asyncpg\connection.py", line 657, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\asyncpg\connection.py", line 443, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.InvalidDatetimeFormatError: неверный синтаксис для типа date: "2025-06"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidDatetimeFormatError'>: неверный синтаксис для типа date: "2025-06"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\WrokingProjects\PythonProject\src\bot\handlers\handlers.py", line 52, in handle_text_query
    res = await session.execute(text(sql_query))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "D:\WrokingProjects\PythonProject\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidDatetimeFormatError'>: неверный синтаксис для типа date: "2025-06"
[SQL: SELECT SUM(views_count) FROM videos WHERE DATE(video_created_at) = '2025-06']
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-16 00:22:27 - aiogram.event - INFO - Update id=738227712 is handled. Duration 664 ms by bot id=7844736553
2025-12-16 00:26:09 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:26:09 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:26:09 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:26:09 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:33:54 - __main__ - INFO - Запуск приложения...
2025-12-16 00:33:54 - __main__ - INFO - Все обязательные настройки проверены успешно
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:33:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:33:54 - __main__ - INFO - База данных инициализирована
2025-12-16 00:33:54 - __main__ - INFO - Бот запущен и готов к работе!
2025-12-16 00:33:54 - aiogram.dispatcher - INFO - Start polling
2025-12-16 00:33:54 - aiogram.dispatcher - INFO - Run polling for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
2025-12-16 00:34:05 - aiogram.event - INFO - Update id=738227713 is handled. Duration 190 ms by bot id=7844736553
2025-12-16 00:34:15 - src.bot.handlers.handlers - INFO - Получен запрос Какое суммарное количество просмотров набрали все видео, опубликованные в июне 2025 года?
2025-12-16 00:34:15 - src.llm_service.llm_service - INFO - Отправка запроса в YandexGPT: Какое суммарное количество просмотров набрали все видео, опубликованные в июне 2025 года?
2025-12-16 00:34:16 - src.llm_service.llm_service - INFO - Сырой ответ от YandexGPT (repr): 'SELECT SUM(views_count) FROM videos WHERE EXTRACT(YEAR FROM video_created_at) = 2025 AND EXTRACT(MONTH FROM video_created_at) = 6'
2025-12-16 00:34:16 - src.llm_service.llm_service - INFO - Очищенный SQL: 'SELECT SUM(views_count) FROM videos WHERE EXTRACT(YEAR FROM video_created_at) = 2025 AND EXTRACT(MONTH FROM video_created_at) = 6'
2025-12-16 00:34:16 - src.llm_service.llm_service - INFO - Сгенерирован валидный SQL: SELECT SUM(views_count) FROM videos WHERE EXTRACT(YEAR FROM video_created_at) = 2025 AND EXTRACT(MONTH FROM video_created_at) = 6
2025-12-16 00:34:16 - src.bot.handlers.handlers - INFO - Сгенерирован SQL: SELECT SUM(views_count) FROM videos WHERE EXTRACT(YEAR FROM video_created_at) = 2025 AND EXTRACT(MONTH FROM video_created_at) = 6
2025-12-16 00:34:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-16 00:34:16 - sqlalchemy.engine.Engine - INFO - SELECT SUM(views_count) FROM videos WHERE EXTRACT(YEAR FROM video_created_at) = 2025 AND EXTRACT(MONTH FROM video_created_at) = 6
2025-12-16 00:34:16 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-12-16 00:34:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-16 00:34:16 - aiogram.event - INFO - Update id=738227714 is handled. Duration 1197 ms by bot id=7844736553
2025-12-16 00:38:39 - aiogram.dispatcher - INFO - Polling stopped
2025-12-16 00:38:39 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-16 00:38:39 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7844736553)
2025-12-16 00:38:39 - aiogram.dispatcher - INFO - Polling stopped for bot @VideoStAt_bot id=7844736553 - 'VideoStatBot'
